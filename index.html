<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>PortfÃ¶y Dashboard</title>

<style>
:root {
  --bg:#0b1220;
  --card:#111827;
  --soft:#1f2937;
  --pos:#22c55e;
  --neg:#ef4444;
}

body {
  margin:0;
  padding:24px;
  background:var(--bg);
  color:#e5e7eb;
  font-family:Inter, system-ui, Arial;
}

h2 {
  margin:32px 0 14px;
  font-size:18px;
  font-weight:600;
}

.grid-3 { display:grid; grid-template-columns:repeat(3,1fr); gap:18px; }
.grid-4 { display:grid; grid-template-columns:repeat(4,1fr); gap:18px; }

.card {
  background:linear-gradient(180deg,var(--card),#0e1627);
  border-radius:18px;
  padding:22px;
  box-shadow:0 12px 30px rgba(0,0,0,.45);
}

.big {
  font-size:26px;
  font-weight:700;
  margin-top:6px;
}

.small { opacity:.65; font-size:13px }

.type-card {
  cursor:pointer;
  transition:.25s;
  border:2px solid transparent;
}

.type-card:hover { transform:translateY(-4px); }

.type-card.active {
  border-color:var(--pos);
  box-shadow:0 0 0 2px rgba(34,197,94,.25);
}

.pos { color:var(--pos) }
.neg { color:var(--neg) }
</style>
</head>

<body>

<h2>ðŸ“Š Genel Ã–zet</h2>
<div class="grid-3" id="summary"></div>

<h2>ðŸ’¼ TÃ¼r BazlÄ± GÃ¼ncel DeÄŸer</h2>
<div class="grid-4" id="types"></div>

<h2>ðŸ“ˆ DÃ¶nemsel K/Z</h2>
<div class="grid-3" id="periods"></div>

<script>
const CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQLPFVZn0j8Ygu914QDGRCGKsVy88gWjdk7DFi-jWiydmqYsdGUE4hEAb-R_IBzQmtFZwoMJFcN6rlD/pub?gid=1050165900&single=true&output=csv";

let DATA=[], ACTIVE="ALL";

fetch(CSV_URL).then(r=>r.text()).then(t=>{
  const rows=t.trim().split("\n").map(r=>r.split(","));
  const h=rows.shift();

  DATA=rows.map(r=>{
    let o={};
    h.forEach((k,i)=>o[k]=isNaN(r[i])?r[i]:Number(r[i]));
    return o;
  });

  renderAll();
});

const sum=(a,k)=>a.reduce((x,y)=>x+(y[k]||0),0);
const byTur=t=>t==="ALL"?DATA:DATA.filter(x=>x.tur===t);

function renderAll(){
  renderSummary();
  renderTypes();
  renderPeriods();
}

function renderSummary(){
  const t=sum(DATA,"toplamYatirim");
  const g=sum(DATA,"guncelDeger");
  const kz=g-t;

  document.getElementById("summary").innerHTML=`
    <div class="card"><div class="small">Toplam YatÄ±rÄ±m</div><div class="big">${t.toLocaleString()}</div></div>
    <div class="card"><div class="small">GÃ¼ncel DeÄŸer</div><div class="big">${g.toLocaleString()}</div></div>
    <div class="card ${kz>=0?"pos":"neg"}"><div class="small">Toplam K/Z</div><div class="big">${kz.toLocaleString()}</div></div>
  `;
}

function renderTypes(){
  ["Hisse","Fon","Mevduat","Bono"].forEach(t=>{
    const v=sum(DATA.filter(x=>x.tur===t),"guncelDeger");
    document.getElementById("types").innerHTML+=`
      <div class="card type-card ${ACTIVE===t?"active":""}" onclick="select('${t}')">
        <div class="small">${t}</div>
        <div class="big">${v.toLocaleString()}</div>
      </div>`;
  });
}

function renderPeriods(){
  const d=byTur(ACTIVE);
  const p=[["GÃ¼nlÃ¼k","gunluk"],["HaftalÄ±k","haftalik"],["AylÄ±k","aylik"],["3 AylÄ±k","ucAylik"],["6 AylÄ±k","altiAylik"],["1 YÄ±llÄ±k","birYillik"]];

  document.getElementById("periods").innerHTML=p.map(x=>{
    const v=sum(d,x[1]);
    return `<div class="card ${v>=0?"pos":"neg"}"><div class="small">${x[0]} K/Z</div><div class="big">${v.toLocaleString()}</div></div>`;
  }).join("");
}

function select(t){
  ACTIVE=t;
  document.getElementById("types").innerHTML="";
  renderTypes();
  renderPeriods();
}
</script>

</body>
</html>
