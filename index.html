<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>PortfÃ¶y Dashboard</title>

<style>
body {
  font-family: Inter, Arial;
  background:#0f172a;
  color:#fff;
  padding:20px;
}

h2 { margin:30px 0 15px }

.grid-4 {
  display:grid;
  grid-template-columns:repeat(4,1fr);
  gap:16px;
}

.grid-3 {
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:16px;
}

.card {
  background:#111827;
  border-radius:16px;
  padding:20px;
  cursor:pointer;
  box-shadow:0 8px 18px rgba(0,0,0,.35);
  transition:.2s;
}

.card:hover {
  transform:translateY(-3px);
  box-shadow:0 12px 24px rgba(0,0,0,.5);
}

.card.active {
  outline:3px solid #22c55e;
}

small { opacity:.7 }
.pos { color:#22c55e }
.neg { color:#ef4444 }
</style>
</head>

<body>

<h2>ðŸ’¼ TÃ¼r BazlÄ± GÃ¼ncel DeÄŸer</h2>
<div class="grid-4" id="typeCards"></div>

<h2>ðŸ“ˆ DÃ¶nemsel K/Z</h2>
<div class="grid-3" id="kzCards"></div>

<script>
const CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQLPFVZn0j8Ygu914QDGRCGKsVy88gWjdk7DFi-jWiydmqYsdGUE4hEAb-R_IBzQmtFZwoMJFcN6rlD/pub?gid=1050165900&single=true&output=csv";

let DATA = [];
let ACTIVE_TUR = "ALL";

fetch(CSV_URL)
  .then(r=>r.text())
  .then(t=>{
    const rows = t.trim().split("\n").map(r=>r.split(","));
    const h = rows.shift();

    DATA = rows.map(r=>{
      let o={};
      h.forEach((k,i)=>o[k]=isNaN(r[i])?r[i]:Number(r[i]));
      return o;
    });

    renderTypes();
    renderKZ();
  });

function sum(arr,key){
  return arr.reduce((a,b)=>a+(b[key]||0),0);
}

function getDataByTur(tur){
  return tur==="ALL" ? DATA : DATA.filter(x=>x.tur===tur);
}

function renderTypes(){
  const types = ["Hisse","Fon","Mevduat","Bono"];

  document.getElementById("typeCards").innerHTML =
    types.map(t=>{
      const total = sum(DATA.filter(x=>x.tur===t),"guncelDeger");
      return `
        <div class="card ${ACTIVE_TUR===t?"active":""}"
             onclick="selectTur('${t}')">
          <small>${t}</small><br>
          <b>${total.toLocaleString()}</b>
        </div>`;
    }).join("");
}

function renderKZ(){
  const d = getDataByTur(ACTIVE_TUR);

  const cards = [
    ["GÃ¼nlÃ¼k","gunluk"],
    ["HaftalÄ±k","haftalik"],
    ["AylÄ±k","aylik"],
    ["3 AylÄ±k","ucAylik"],
    ["6 AylÄ±k","altiAylik"],
    ["1 YÄ±llÄ±k","birYillik"]
  ];

  document.getElementById("kzCards").innerHTML =
    cards.map(c=>{
      const v = sum(d,c[1]);
      return `
        <div class="card ${v>=0?"pos":"neg"}">
          <small>${c[0]} K/Z</small><br>
          <b>${v.toLocaleString()}</b>
        </div>`;
    }).join("");
}

function selectTur(t){
  ACTIVE_TUR = t;
  renderTypes();
  renderKZ();
}
</script>

</body>
</html>
