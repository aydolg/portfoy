<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PortfÃ¶y Dashboard</title>

<style>
body{
  font-family: Inter, Arial, sans-serif;
  background:#0f1115;
  color:#eaeaea;
  margin:0;
}
.container{
  max-width:1200px;
  margin:auto;
  padding:16px;
}
h1{
  margin:0 0 16px;
}
.grid{
  display:grid;
  grid-template-columns: repeat(auto-fit,minmax(220px,1fr));
  gap:12px;
}
.card{
  background:#1a1d24;
  border-radius:12px;
  padding:16px;
}
.card h3{
  margin:0 0 8px;
  font-size:14px;
  color:#9aa0a6;
}
.card .value{
  font-size:22px;
  font-weight:600;
}
.positive{ color:#3ddc84 }
.negative{ color:#ff6b6b }

.filters{
  margin:16px 0;
  display:flex;
  gap:8px;
  flex-wrap:wrap;
}
button{
  background:#242833;
  color:#fff;
  border:none;
  padding:8px 14px;
  border-radius:8px;
  cursor:pointer;
}
button.active{
  background:#3b82f6;
}
</style>
</head>

<body>
<div class="container">
  <h1>ðŸ“Š PortfÃ¶y Dashboard</h1>

  <!-- ÃœST KARTLAR -->
  <div class="grid">
    <div class="card">
      <h3>Toplam YatÄ±rÄ±m</h3>
      <div class="value" id="toplamYatirim">-</div>
    </div>
    <div class="card">
      <h3>GÃ¼ncel DeÄŸer</h3>
      <div class="value" id="guncelDeger">-</div>
    </div>
    <div class="card">
      <h3>Toplam K/Z</h3>
      <div class="value" id="toplamKZ">-</div>
    </div>
  </div>

  <!-- FÄ°LTRE -->
  <div class="filters">
    <button class="active" onclick="applyFilter(null,this)">TÃ¼mÃ¼</button>
    <button onclick="applyFilter('Hisse',this)">Hisse</button>
    <button onclick="applyFilter('Mevduat',this)">Mevduat</button>
    <button onclick="applyFilter('Bono',this)">Bono</button>
  </div>

  <!-- ALT KARTLAR -->
  <div class="grid">
    <div class="card"><h3>GÃ¼nlÃ¼k K/Z</h3><div class="value" id="gunluk">-</div></div>
    <div class="card"><h3>HaftalÄ±k K/Z</h3><div class="value" id="haftalik">-</div></div>
    <div class="card"><h3>AylÄ±k K/Z</h3><div class="value" id="aylik">-</div></div>
    <div class="card"><h3>3 AylÄ±k K/Z</h3><div class="value" id="ucAylik">-</div></div>
    <div class="card"><h3>6 AylÄ±k K/Z</h3><div class="value" id="altiAylik">-</div></div>
    <div class="card"><h3>1 YÄ±llÄ±k K/Z</h3><div class="value" id="birYillik">-</div></div>
  </div>
</div>

<script>
const CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQLPFVZn0j8Ygu914QDGRCGKsVy88gWjdk7DFi-jWiydmqYsdGUE4hEAb-R_IBzQmtFZwoMJFcN6rlD/pub?gid=1050165900&single=true&output=csv";

let RAW_DATA = [];
let CURRENT_DATA = [];

fetch(CSV_URL)
.then(r=>r.text())
.then(csv=>{
  const rows = csv.split("\n").map(r=>r.split(","));
  rows.shift();

  RAW_DATA = rows.map(r=>({
    urun:r[0],
    tur:r[1],
    toplamYatirim:+r[2]||0,
    guncelDeger:+r[3]||0,
    gunluk:+r[4]||0,
    haftalik:+r[5]||0,
    aylik:+r[6]||0,
    ucAylik:+r[7]||0,
    altiAylik:+r[8]||0,
    birYillik:+r[9]||0
  }));

  CURRENT_DATA = RAW_DATA;
  renderAll();
});

function applyFilter(type,btn){
  document.querySelectorAll("button").forEach(b=>b.classList.remove("active"));
  btn.classList.add("active");

  CURRENT_DATA = type ? RAW_DATA.filter(d=>d.tur===type) : RAW_DATA;
  renderAll();
}

function sum(key){
  return CURRENT_DATA.reduce((a,b)=>a+(b[key]||0),0);
}

function setVal(id,val){
  const el=document.getElementById(id);
  el.innerText = val.toLocaleString("tr-TR",{maximumFractionDigits:2});
  el.className="value "+(val>=0?"positive":"negative");
}

function renderAll(){
  const toplamYatirim = sum("toplamYatirim");
  const guncelDeger = sum("guncelDeger");
  const toplamKZ = guncelDeger - toplamYatirim;

  setVal("toplamYatirim",toplamYatirim);
  setVal("guncelDeger",guncelDeger);
  setVal("toplamKZ",toplamKZ);

  setVal("gunluk",sum("gunluk"));
  setVal("haftalik",sum("haftalik"));
  setVal("aylik",sum("aylik"));
  setVal("ucAylik",sum("ucAylik"));
  setVal("altiAylik",sum("altiAylik"));
  setVal("birYillik",sum("birYillik"));
}
</script>
</body>
</html>
