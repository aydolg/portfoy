<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>PortfÃ¶y Dashboard</title>

<style>
body { font-family: Arial; background:#0f172a; color:#fff; margin:0; padding:20px }
.grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(200px,1fr)); gap:15px }
.card { background:#111827; padding:15px; border-radius:10px }
.green{color:#22c55e} .red{color:#ef4444}
.yellow{color:#eab308} .black{color:#000}
select { padding:8px; border-radius:6px }
</style>
</head>

<body>

<h2>ðŸ“Š PortfÃ¶y Dashboard</h2>

<select id="turFilter">
  <option value="ALL">TÃ¼mÃ¼</option>
  <option value="Hisse">Hisse</option>
  <option value="Fon">Fon</option>
  <option value="Mevduat">Mevduat</option>
  <option value="Bono">Bono</option>
</select>

<div class="grid" id="cards"></div>

<script>
const CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQLPFVZn0j8Ygu914QDGRCGKsVy88gWjdk7DFi-jWiydmqYsdGUE4hEAb-R_IBzQmtFZwoMJFcN6rlD/pub?gid=1050165900&single=true&output=csv";

fetch(CSV_URL)
.then(r => r.text())
.then(text => {
  const lines = text.trim().split("\n");
  const headers = lines.shift().split(",");

  const data = lines.map(l => {
    const v = l.split(",");
    let o = {};
    headers.forEach((h,i)=> o[h]=isNaN(v[i])?v[i]:Number(v[i]));
    return o;
  });

  render(data);

  document.getElementById("turFilter").onchange = e =>
    render(e.target.value==="ALL"?data:data.filter(d=>d.tur===e.target.value));
});

function sum(arr,key){return arr.reduce((a,b)=>a+(b[key]||0),0)}

function render(d){
  const cards = document.getElementById("cards");
  cards.innerHTML = `
    <div class="card">Toplam YatÄ±rÄ±m<br><b>${sum(d,"toplamYatirim").toLocaleString()}</b></div>
    <div class="card">GÃ¼ncel DeÄŸer<br><b>${sum(d,"guncelDeger").toLocaleString()}</b></div>
    <div class="card ${sum(d,"gunluk")>=0?"green":"red"}">GÃ¼nlÃ¼k K/Z<br><b>${sum(d,"gunluk").toLocaleString()}</b></div>
    <div class="card ${sum(d,"haftalik")>=0?"green":"red"}">HaftalÄ±k K/Z<br><b>${sum(d,"haftalik").toLocaleString()}</b></div>
    <div class="card ${sum(d,"aylik")>=0?"green":"red"}">AylÄ±k K/Z<br><b>${sum(d,"aylik").toLocaleString()}</b></div>
    <div class="card ${sum(d,"ucAylik")>=0?"green":"red"}">3 AylÄ±k K/Z<br><b>${sum(d,"ucAylik").toLocaleString()}</b></div>
    <div class="card ${sum(d,"altiAylik")>=0?"green":"red"}">6 AylÄ±k K/Z<br><b>${sum(d,"altiAylik").toLocaleString()}</b></div>
    <div class="card ${sum(d,"birYillik")>=0?"green":"red"}">1 YÄ±llÄ±k K/Z<br><b>${sum(d,"birYillik").toLocaleString()}</b></div>
  `;
}
</script>

</body>
</html>
