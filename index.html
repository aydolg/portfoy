function vadeleriTakvimeIsle() {
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var sheet = ss.getActiveSheet();
  var data = sheet.getDataRange().getValues();
  var takvim = CalendarApp.getDefaultCalendar();
  
  for (var i = 1; i < data.length; i++) {
    var varlikAdi = data[i][0]; // A Sütunu
    var vadeTarihi = new Date(data[i][2]); // D Sütunu (Index 2)
    
    if (vadeTarihi instanceof Date && !isNaN(vadeTarihi)) {
      // Daha önce eklenmiş mi kontrol et (mükerrer kayıt önleme)
      var etkinlikler = takvim.getEventsForDay(vadeTarihi, {search: varlikAdi});
      
      if (etkinlikler.length == 0) {
        takvim.createAllDayEvent("VADE SONU: " + varlikAdi, vadeTarihi);
        console.log(varlikAdi + " için takvim kaydı oluşturuldu.");
      }
    }
  }
}
